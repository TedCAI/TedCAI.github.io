---
layout: post
title: C++内存管理,堆栈溢出问题总结
category: C++
description: C++内存管理,堆栈溢出问题总结
tags: ["C++"]
---

### 堆和栈的区别
在C++中，内存分成5个区，他们分别是堆、栈、自由存储区、全局/静态存储区和常量存储区。
(1)栈，就是那些由编译器在需要的时候分配，在不需要的时候自动清楚的变量的存储区。里面的变量通常是局部变量、函数参数等。
(2)堆，就是那些由new分配的内存块，他们的释放编译器不去管，由我们的应用程序去控制，一般一个new就要对应一个delete。如果程序员没有释放掉，那么在程序结束后，操作系统会自动回收。
(3)自由存储区，就是那些由malloc等分配的内存块，他和堆是十分相似的，不过它是用free来结束自己的生命的。
(4)全局/静态存储区，全局变量和静态变量被分配到同一块内存中，在以前的C语言中，全局变量又分为初始化的和未初始化的，在C++里面没有这个区分了，他们共同占用同一块内存区。
(5)常量存储区，这是一块比较特殊的存储区，他们里面存放的是常量，不允许修改（通过非正当手段也可以修改）

堆和栈的区别可以用如下的比喻来看出：    
(1)
使用栈就象我们去饭馆里吃饭，只管点菜（发出申请）、付钱、和吃（使用），吃饱了就  
走，不必理会切菜、洗菜等准备工作和洗碗、刷锅等扫尾工作，他的好处是快捷，但是自  
由度小。  
(2)
使用堆就象是自己动手做喜欢吃的菜肴，比较麻烦，但是比较符合自己的口味，而且自由  
度大。

### C++调用大数组出现栈溢出的问题解决方法，堆和栈的完全解析
总结：除非特别要求，不应开一个大于>100的数组，是很不明智的！

主要有两个办法：
一 改为堆变量：
int* pa = malloc(sizeof(int)*1000*1000);
然后可以将pa当数组用。（数组和指针在C里基本等同）
当然，不用了记得free pa。

二 修改系统限制
这个栈变量= 1000*1000*4 = 4M。（约等于）
如果这个函数不频繁调用，也不递归，一般还是可以接受。
可以修改操作系统对进程栈空间的大小限制，稍微调大一些。

当然方法二非常不值得推荐

reference:http://blog.csdn.net/feeltouch/article/details/9400095